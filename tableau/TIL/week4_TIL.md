# Fourth Study Week

- 30강: [계층](#30-계층)

- 31강: [집합](#31-집합)

- 32강: [결합집합](#32-결합집합)

- 33강: [계산된 필드](#33-계산된-필드)

- 34강: [행수준계산](#34-행수준계산)

- 35강: [집계계산](#35-집계계산)

- 36강: [테이블계산](#36-테이블계산)

- 37강: [퀵테이블계산(1)](#37-퀵테이블계산1)

- 38강: [퀵테이블계산(2)](#38-퀵테이블계산2)

- [문제1](#문제-1)

- [문제2](#문제-2)

- [문제3](#문제-3)

## Study Schedule

| 강의 범위 | 강의 이수 여부 | 링크                                                                                                 |
| --------- | -------------- | ---------------------------------------------------------------------------------------------------- |
| 1~9강     | ✅             | [링크](https://www.youtube.com/watch?v=AXkaUrJs-Ko&list=PL87tgIIryGsa5vdz6MsaOEF8PK-YqK3fz&index=84) |
| 10~19강   | ✅             | [링크](https://www.youtube.com/watch?v=AXkaUrJs-Ko&list=PL87tgIIryGsa5vdz6MsaOEF8PK-YqK3fz&index=75) |
| 20~29강   | ✅             | [링크](https://www.youtube.com/watch?v=AXkaUrJs-Ko&list=PL87tgIIryGsa5vdz6MsaOEF8PK-YqK3fz&index=65) |
| 30~38강   | ✅             | [링크](https://youtu.be/e6J0Ljd6h44?si=nhGbB7GsdOCqj15f)                                             |
| 39~49강   | 🍽️             | [링크](https://www.youtube.com/watch?v=AXkaUrJs-Ko&list=PL87tgIIryGsa5vdz6MsaOEF8PK-YqK3fz&index=45) |
| 50~59강   | 🍽️             | [링크](https://www.youtube.com/watch?v=AXkaUrJs-Ko&list=PL87tgIIryGsa5vdz6MsaOEF8PK-YqK3fz&index=35) |
| 60~69강   | 🍽️             | [링크](https://www.youtube.com/watch?v=AXkaUrJs-Ko&list=PL87tgIIryGsa5vdz6MsaOEF8PK-YqK3fz&index=25) |
| 70~79강   | 🍽️             | [링크](https://www.youtube.com/watch?v=AXkaUrJs-Ko&list=PL87tgIIryGsa5vdz6MsaOEF8PK-YqK3fz&index=15) |
| 80~89강   | 🍽️             | [링크](https://www.youtube.com/watch?v=AXkaUrJs-Ko&list=PL87tgIIryGsa5vdz6MsaOEF8PK-YqK3fz&index=5)  |

<!-- 여기까진 그대로 둬 주세요-->

> **🧞‍♀️ 오늘의 스터디는 지니와 함께합니다.**

## 30. 계층

<!-- 계층 구조와 관련된 개념, 사용 방법 등을 적어주세요. -->

```
계층 : 뷰에서 데이터를 드릴 다운하여 값을 세부적으로 찾을 떄 유용한 방법

- 지역, 국가, 시도, 도시 등이 계층으로 묶인 '위치필드'
- 마우스 우클릭후 계층 제거를 하여 계층을 제거 가능

<계층만들기>
- 두 필드 선택 후 우클릭
- 계층 -> 계층 만들기 클릭
- 원하는 필드 계층 만들고 싶으면 계층에 넣으면 됨

```

## 31. 집합

<!-- 집합의 정의 및 활용 방법에 대해 알게 된 점을 적어주세요. -->

```
집합 : 사용자가 어떤 조건을 선정하고, 그 조건을 기반으로 데이터 구분

< 수익을 많이 낸 상위 10개 도시들을 구분해보기 using 집합 >

- 시도 우클릭 -> 집합 만들기
- 일반, 조건, 상위 탭 존재.
- 여기서 상위 선택
- 필드기준을 상위로 선택하기
- 그럼 필드가 생성되고, 그 필드를 마크 카드의 색상탭에 올리기.
- 뷰 오른쪽 필터의 색상편집을 눌러 색상 변경 가능

```

## 32. 결합집합

<!-- 결합집합의 개념 및 사용 사례를 적어주세요. -->

```
두가지 조건을 적용하고 싶으면? -> 결합된 집합 사용하기

<매출 5만원 이상, 수익률 10% 이상인 도시 데이터 구분하기>
- 매출 5만원 이상인 도시 구분하는 집합 필드 만들기
- 시도 우클릭, 집합 클릭
- 조건 '필드 기준'의 '매출' 선택하기
- > 선택, 50000 입력
- 매출을 텍스트, 시도를 행
- 해당 집합 필드를 색상에 올리기
- 내림차순으로 변경하기
- 두번째 필드 만들기
- 시도필드 우클릭 & 집합 만들기 -> 조건탭 -> 수익률 필드 선택 -> 이상 선택, 0.1입력
- 수익률 텍스트, 방금만든 필드 색상에
(이제 두 집합 결합하기)
- 첫번째 만들어진 필드 우클릭 -> 결합된 집합 만들기
- 우리가 만든 2개의 집합 선택하기
- 결합 방법으로 4가지 방법이 있음. 원하는 방법 선택하기
- 확인 클릭 & 결합된 집합 필드 색상에 올리기


```

## 33. 계산된 필드

<!-- 계산된 필드를 사용하는 방법과 예시를 적어주세요. -->

```
계산된 필드 : 데이터 원본에 있는 필드를 활용해 새로운 필드를 만들때 사용

<계산된 필드 만드는 방법 3가지>
1. 데이터 패널로 만들기
2. 분석 탭으로 만들기
3. 원하는 필드 우클릭 후 만들기

왼쪽 기호를 클릭해보면, 함수에 대한 정보를 볼 수 있다.

<계산된 필드에서 컬럼 활용하기>
1. 필드 드래그 앤 드랍
2. 필드 직접 입력

```

제품별로 어느정도의 수익을 냈는지 백분율로 알아보기

```
sum(수익) / sum(매출)
```

```
<백분율로 나타내기>
- 해당 필드선택 & 우클릭
- 기본속성 -> 숫자형식 클릭
- 백분율 선택(소수점자릿수는 0으로)
```

## 34. 행수준계산

<!-- 행수준 계산의 의미와 적용 방법을 적어주세요. -->

```
<계산된 필드를 크게 3가지로 구분>
1. 기본 계산
2. 테이블 계산
3. LOD 표현식

<1. 기본계산>
: 데이터 원본에 대한 행 수준 계산 또는 집계 계산

( 고객이름 필드의 성과 이름 분리하기 )
- 데이터 패널 계산된 필드 만들기 선택
- 이름 : 고객 이름 (분리)
- SPLIT([고객 이름], ' ', 1)
- 이름 : 고객 성 (분리)
- SPLIT([고객 이름], ' ', 2)

( 수익성 나타내는 필드 만들기 - IF-THEN 함수 사용 )
- 데이터 패널 계산된 필드 만들기
- 이름 : 수익성
---------------------------------
IF [수익] > 0 THEN '수익성 있음'
ELSEIF [수익] < 0 THEN '수익성 없음'
ELSE '손익 평형'
END
---------------------------------
- 이 필드를 행 선반에 드래그 앤 드랍

( DATEDIFF를 통해 두 날짜 사이의 일 수를 찾아보기 )
- 이름 : 주문 처리 일수
-------------------------------------
DATEDIFF('day', [주문 날짜], [배송 날짜])
-------------------------------------
- 주문id필드와 주문날짜, 배송날짜 필드를 행선반으로.
- 주문날짜 필드를 우클릭후 자세히 -> 사용자 지정 선택 -> 사용자 지정 날짜 창 : 연도/월/일 클릭하기
- 배송날짜 필드도 마찬가지로 변경하기
- 주문 처리 일수 필드를 마크 카드의 텍스트 위로 drag and drop.

```

## 35. 집계계산

<!-- 집계계산의 정의 및 활용 사례에 대해 알게 된 점을 적어주세요. -->

```
Tableau에서는 기본 계산방식이 두 가지 존재.
-> 그 중 집계계산이란, 현재 뷰에서 보이는 기준으로 계산하는 방식이다.

<기본으로 설정되어 있는 집계 계산 변경하기>
- 필드 마우스 우클릭 -> 기본속성에 '집계' 선택하여 원하는 집계 선택 가능.

계산된 필드 창에서 드랍다운 목록을 통해 집계계산 함수만 볼 수 있기도 하다.

<집계 계산식을 통해 계산된 필드 만들어보기>
이름 : 합계 매출 집계 계산
-------------
SUM([매출])
-------------

- 제조업체 필드와 생성된 필드, '매출' 필드를 더블 클릭하고 측정값 선반의 필드들 확인해보기
- 두 필드 사이에 차이가 있음을 알 수 있다. (집계와 합계. 합계가 태블로가 자동으로 만든 것이다.)
```

중복을 제외한 유니크한 값만 세야할때

```
COUNTD(ID)
```

## 36. 테이블계산

<!-- 테이블 계산의 개념 및 사용 방법을 적어주세요. -->

```
테이블 계산 : 뷰에 보이는 내용을 바탕으로 데이터를 계산

- 주문날짜, 매출 더블클릭, 주문날짜 열, 분기와 월 행
- 계산된 필드 만들기, 드랍다운 테이블계산 선택

(월마다, 연도따라 누적 매출 찾기)
이름 : 누적 매출
---------------------------
RUNNING_SUM(SUM([매출]))
---------------------------
생성된 필드 마크카드 -> 텍스트 위에 드래그 : 뷰에서 누계된 매출 확인 가능.
생성된 필드의 세모표시는 테이블 계산 필드를 의미한다.

(집계방향 변경해보기)
<1번째 방법>
1. 해당 필드에 마우스 우 클릭하여 다음을 사용하여 계산
2. 그럼 여러가지 계산 방향을 보여준다. 여기서 선택하면 됨!

<2번째 방법>
1. 계산된 필드에 마우스 우클릭 -> 테이블 계산 편집 옵션 선택.
2. 나타나는 화면에 계산 방향 선택 가능, 계산 옵션 추가 가능

```

## 37. 퀵테이블계산(1)

<!-- 퀵테이블 계산의 원리 및 예제에 대해 알게 된 점을 적어주세요. -->

```
"퀵 테이블 계산"
: 테이블 계산에서 가장 자주 쓰이는 테이블 계산 유형들을 클릭만으로 가능하도록 만들어 놓은 기능
- 사용하고자 하는 필드 위에 마우스 우 클릭 후 "퀵 테이블 계산" 선택
- 그럼 관련 테이블 계산 유형들이 나열되어 나타남.

<누계> : 집계한 값을 누적한 값으로 한번 더 집계해주는 계산 유형

(분기별 누적 매출 & 월별 매출 차트 만들어보기)
- 주문날짜 열에 분기(연속형)으로 놓기
- 매출 행으로 드래그앤드랍
- 매출 + command -> 옆으로 복제하기
- 복제한 매출 테이블의 퀵 테이블 계산에서 "누계"선택
- 밑의 그래프 선택후 이중축 만들기! & 축 동기화

(퀵 테이블 계산의 차이 이용해보기 - 각 제품에 대한 연도별 매출 차이 알아보기)
- 주문 날짜 필드를 열 선반에, 범주 필드를 행 선반에
- 매출 필드 텍스트
- 마크카드속 매출필드 우클릭 -> 퀵 테이블 계산 -> 차이 선택
- '차이'란, 측정값이 기준값과 어느 정도 차이가 나는 지 구하는 계산 유형이다.
    - 기준값으론 '이전'이 기본값으로 설정되어있고, 총 4가지 옵션을 지정할 수 있다.

('비율 차이'는 측정값들 사이의 성장률 또는 % 차이를 표현한다.)
('구성 비율': 전체에서 각 항목들의 비중을 확인할 때 활용)
(백분위 수 : 전체에서 각 멤버들의 백분위를 표시하도록 한다.)
- 고객이름 행, 매출 필드 더블클릭
- 마크선반에서 '매출' 필드 위로 마우스 우 클릭->퀵테이블계산-> 백분위수
- 상단툴바 내림차순 클릭 => 매출을 가장 많이 기록한 고객을 100%로 표시한다.

```

## 38. 퀵테이블계산(2)

<!-- 이동평균, YTD 총계, 전년 대비 성장률, YTD 성장률 등 본 강의에서 알게 된 점을 적어주세요. -->

```
<이동평균>
: 이전의 값부터 현재까지 값에 대한 평균을 낼 때 사용하며, 주식 데이터에서 많이 활용됨.
- 연속형 '분기'(주문날짜)와 매출을 각 열 선반, 행 선반에 drag&drop하기
- 매출필드를 command로 복사 -> 우클릭 -> 퀵 -> 이동편균 선택
- 뷰에 값들을 표시하기위해 매출필드를 command누르고 마크카드의 레이블 위로 올림.
- 두번째 매출 필드에 마우스 우 클릭해 '테이블 계산 편집' 선택하기.
- 여기서 보면 현재 레이블로 표시되는 각각의 분기를 기준으로 이전 두 분기(이전2)와 현재 분기의 (다음 0) 분기별 평균이라고 할 수 있다.

<YTD 총계>
: Year to Date 총계. 특정 시점을 기준으로 해당 연도부터 그 시점까지 총계
누계와 같은 개념이나, '연도'보다 하위레벨 필드인 '분기' 또는 '월'이 있어야 사용가능.
- 주문날짜 필드를 행 선반에, 년 월만 표시되도록하기.
- 매출 더블 클릭 -> 년/월별 매출 합계가 표시되도록 한다.
- 마크카드의 매출 필드 우클릭, 퀵 -> YTD총계 선택
- 매출 더블클릭해서 확인하기

<통합 성장률(Compound Growth Rate)>
- 주문날짜 필드 행선반에,년 분기만 표시
- 매출 더블 클릭, 년/월별 매출합계가 표시되도록 함.
- 마크 카드의 매출 필드 우 클릭 후, 퀵 -> 통합 성장률 선택

<전년 대비 성장률 (Year Over Year Growth)>
: 같은 월을 기준으로 이전 연도 대비 얼마 정도 성장했는지 살펴보는데 활용함.
- 주문날짜 행선반 (년, 월만 표시되도록)
- 매출 더블 클릭, 년/월별 매출의 합계가 표시되도록 함.
- 마크카드의 '매출'필드 마우스 우 클릭, 퀵 테이블 계산 -> '전년 대비 성장률' 선택.

<YTD 성장률(Year to Date Growth)>
: 주문날짜 행선반 (년, 월만 표시되도록)
- 매출 더블클릭 -> 테이블 안에 각 연월 기준 매출 합계 값이 나온다.
- 마크카드의 매출 필드를 마우스 우 클릭하여 퀵 테이블 계산에서 'YTD 성장률'을 선택!
- 해당 성장률 값을 검증하기 위해서 데이터패널의 매출 더블클릭
- 측정값 카드의 퀵 테이블 계산이 적용된 '매출'필드 더블 클릭(세모표시)
- 동작 완료 불가 에러 발생! (이는 단일 계산식이 아니기 때문이다.)
- 이를 확인하기 위해 측정값 카드에 있는 퀵이 적용된 합계(매출)필드를 command누른 상태로 데이터 패널로 던지기
- '계산1', '계산1 1' 필드 두개 생성
- '계산1' => 'YTD 총계'로 변형
- '계산 1 1' => 'YTD 성장률'로 필드명 변경
- 그리고 생성한 'YTD총계' 필드를 측정값 가운데에 넣어준다.


```

## 문제 1.

규석이는 이제껏 매출을 올리는 데에 힘썼었지만, 왠지 모르게 주머니에 들어오는 돈이 없어 속상합니다.

그래서 매출이 상위 20곳에 속하지만, 수익률(%)이 마이너스인 시/도를 확인하려고 합니다.

> 수익률은 SUM([수익]) / SUM([매출])로 정의합니다.

어떤 집합을 만들었고, 어떤 결합을 하였는지를 중심으로 기술하고, 결과 자료를 첨부해주세요.

(텍스트 표 형태이며, 색상으로 위 집합을 구분할 수 있게 만들어주세요.)

<!-- 아래 예시 이미지를 삭제하고, 직접 만든 시트 사진을 올려주세요. 시트의 이름은 본인 이름으로 기입해주세요-->

![문제 1번](../img/week4/문제%201번.png)

```
시/도의 매출 상위 20개 조건을 건 집합과, 수익률 계산필드를 만들고 시/도에서 '수익률<0'의 조건이 걸린 집합 두개를 만들었다.
그리고 공유 멤버로 결합된 집합을 만들었다. 매출, 수익, 수익률을 표시했다.
수익률이 마이너스인 시/도는 파란색으로 칠해진 IN 부분이다.
```

## 문제 2.

선희는 주문 Id별로 주문에서 배송까지에 걸리는 날짜 일수가 궁금했습니다.
그래서 주문 ID별로 주문에서 배송까지 걸리는 일자를 '배송까지 걸린 일수'라는 계산된 필드로 만들고, 이를 마크에 올린 후 확인해보았습니다.
이때, 계산된 필드의 식은 'DATEDIFF' 함수를 이용하였습니다.

배송까지 걸린 일수 계산을 위한 DATEDIFF 함수 수식을 적어주세요.

```
DATEDIFF('day', [주문 날짜], [배송 날짜])
```

![datediff](https://github.com/yousrchive/BUSINESS-INTELLIGENCE-TABLEAU/blob/main/study/img/4th%20til/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202024-09-30%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%203.47.21.png?raw=true)

그런데 위 그림처럼 '주문 날짜'와 '배송 날짜'를 함께 행에 올려 확인해보니, 주문날짜와 배송날짜의 차이가 '배송까지 걸린 일수'와 다릅니다.

ID-2021-11126을 보니, 11월 26일 배송에 11월 30일 배송이면 4일 차이인데, 12일이 걸렸다고 하네요. 왜 이런 문제가 생긴걸까요?

```
ID별 중복을 제외한 유니크한 값이 아닌, 중복을 허용하고 다른 레코드에 나타난 일수를 합쳐서 나타냈기 때문이다.
```

그리고 이를 해결하기 위해서는 어떻게 해야 할까요?

```
계산된 필드의 측정값을 차원값으로 변경한다.
```

## 문제 3.

다음은 Tableau의 다양한 계산을 사용할 수 있는 경우를 빈칸으로 두고 문제를 작성한 것입니다. 각 빈칸에 적합한 계산 유형을 채워보세요.

보기

> **누계, 차이, 비율 차이, 구성 비율, 순위, 백분위수, 이동 평균, YTD 총계, 통합 성장률, 전년 대비 성장률, YTD 성장률**

| 계산 유형        | 설명                                     | 사용 예시                                                                                             |
| ---------------- | ---------------------------------------- | ----------------------------------------------------------------------------------------------------- |
| 누계             | 데이터의 누적 합계를 계산                | 한 기업이 월별 매출 데이터를 누적하여 연간 매출 추이를 보고 싶을 때 사용                              |
| 차이             | 연속 데이터 포인트 간의 차이를 계산      | 한 기업이 월별 매출 데이터에서 전월 대비 매출 증감량을 분석하고 싶은 경우                             |
| 비율차이         | 연속 데이터 포인트 간의 비율 변화를 계산 | 한 기업이 월별 매출 데이터에서 전월 대비 매출 증감률(%)을 분석하고 싶은 경우                          |
| 구성비율         | 전체에서 각 데이터 포인트의 비율을 계산  | 한 기업이 전체 매출에서 각 제품군이 차지하는 비율을 보고 싶을 때 사용                                 |
| 순위             | 데이터의 순위를 매깁니다                 | 한 기업이 제품별 매출 데이터를 순위별로 정렬하여 상위 10개 제품을 분석하고 싶은 경우                  |
| 백분위수         | 데이터의 백분위를 계산                   | 한 기업이 고객별 구매 금액 데이터를 백분위수로 나누어 상위 25% 고객을 분석하고 싶은 경우              |
| 이동평균         | 일정 기간의 평균을 계산                  | 한 기업이 주간 매출 데이터에서 4주 이동 평균을 계산하여 트렌드를 분석하고 싶은 경우                   |
| YTD 총계         | 연초부터 현재까지의 총계를 계산          | 한 기업이 월별 매출 데이터를 연초부터 현재까지 누적하여 연간 매출 목표 달성 여부를 분석하고 싶은 경우 |
| 통합 성장률      | 일정 기간 동안의 연평균 성장률을 계산    | 한 기업이 5년 간 매출 데이터를 바탕으로 연평균 성장률(CAGR)을 계산하고 싶은 경우                      |
| 전년 대비 성장률 | 전년 동기간 대비 성장률을 계산           | 한 기업이 월별 매출 데이터에서 전년 동월 대비 매출 성장률을 분석하고 싶은 경우                        |
| YTD 성장률       | 연초부터 현재까지의 성장률을 계산        | 한 기업이 올해 연초부터 현재까지의 매출이 전년 동기 대비 얼마나 성장했는지 분석하고 싶은 경우         |

> 사용 예시를 참고하여 실제 경우처럼 생각하며 고민해보아요!
